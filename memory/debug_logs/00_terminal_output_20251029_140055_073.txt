================================================================================
TERMINAL OUTPUT FOR THIS TURN
================================================================================
Timestamp: 2025-10-29 14:00:58
Turn ID: turn_20251029_140055_073
================================================================================

   ğŸ“ Debug: User query logged to 01_user_query_20251029_140055_073.txt
   ğŸ” Step 1: Quick keyword extraction...
      Quick keywords: ['interesting fact', 'tell', 'interesting', 'fact', 'ocean']
   ğŸ“š Step 2: Retrieving recent context...
ğŸ” Crawler: Searching with intent:
   Query Type: chat
   Keywords: ['interesting fact', 'tell', 'interesting', 'fact', 'ocean']
ğŸ“‹ Found 0 active tasks
ğŸ“… Search range: ALL DAYS (unlimited)

ğŸ” VECTOR SEARCH (Primary Method):
   ğŸ” Ranked multi-keyword search: 'interesting fact tell interesting fact ocean...'
      Query keywords (6): ['interesting', 'fact', 'tell', 'interesting', 'fact', 'ocean']
      Found 2 turns with keyword matches
   ğŸ¯ Top matches:
      1. score=3.04 | 1 kw matches | avg_sim=0.626 | marine environment...
      2. score=2.87 | 1 kw matches | avg_sim=0.513 | marine organisms...
   âœ… Returning 2 ranked results
   ğŸ”‘ Search query (keywords): 'interesting fact tell interesting fact ocean'
   âœ… Vector search successful, skipping keyword search

ğŸ“Š SEARCH RESULTS SUMMARY:
   Vector results: 2
   Keyword results: 0
   Total candidates: 2
   âœ… Window tracking: 12 turns in window, 0 recently seen
âœ… Retrieved context: 2 snippets, 1 sources
      Retrieved 2 recent contexts
   ğŸ§  Step 3: Analyzing intent WITH context...
   ğŸ“… Phase 6.2: Analyzing with plan context (4 active plans)
      Type: task_request
      Keywords: ['tell', 'interesting', 'fact', 'ocean', 'context']
      Topics: ['product', '500m', 'around']
   ğŸ“ Debug: User query logged to 01_user_query_20251029_140055_073.txt
   ğŸ·ï¸  Phase 4.1: Extracting topics...
      Extracted topics: ['interesting fact', 'interesting', 'fact', 'ocean']
   ğŸ” Step 4: Full context retrieval with refined intent...
      Using plan-boosted retrieval (4 active plans)
ğŸ” Crawler: Searching with intent:
   Query Type: task_request
   Keywords: ['tell', 'interesting', 'fact', 'ocean', 'context', 'metadata', 'intent', 'understanding', 'conversation', 'depth']
   Primary Topics: ['product', '500m', 'around']
ğŸ“‹ Found 0 active tasks
ğŸ“… Search range: ALL DAYS (unlimited)

ğŸ” VECTOR SEARCH (Primary Method):
   ğŸ” Ranked multi-keyword search: 'tell interesting fact ocean context metadata intent understa...'
      Query keywords (13): ['tell', 'interesting', 'fact', 'ocean', 'context', 'metadata', 'intent', 'understanding', 'conversation', 'depth', 'product', '500m', 'around']
      Found 12 turns with keyword matches
   ğŸ¯ Top matches:
      1. score=9.47 | 4 kw matches | avg_sim=0.715 | Conversation, Metadata...
      2. score=5.34 | 2 kw matches | avg_sim=0.424 | Growing, Growing...
      3. score=5.09 | 2 kw matches | avg_sim=0.428 | data structures, getting started...
   âœ… Returning 10 ranked results
   ğŸ”‘ Search query (keywords): 'tell interesting fact ocean context metadata intent understanding conversation depth product 500m around'
   âœ… Vector search successful, skipping keyword search

ğŸ“Š SEARCH RESULTS SUMMARY:
   Vector results: 10
   Keyword results: 0
   Total candidates: 10
   ğŸ“Œ Keeping high-similarity turn t_20251021_125004_8d... (similarity=0.626) despite being in window
   ğŸ”„ Deduplicated turns: 10 â†’ 9 (1 skipped)
   âœ… Window tracking: 16 turns in window, 0 recently seen
âœ… Retrieved context: 5 snippets, 3 sources
      Retrieved: 5 contexts (before topic filtering)
   ğŸ” Phase 4.1: Filtering by active topics...
      Filtered: 5 â†’ 2 contexts
      Final context count: 2
   ğŸ“ Debug: Retrieved context logged to 02_retrieved_context_20251029_140055_073.txt
   ğŸ“ Debug: Sliding window logged to 03_sliding_window_20251029_140055_073.txt
   ğŸ’§ Building contextualized prompt...

ğŸ’§ Building prompt...
   ğŸ“Š Token allocation:
      System: 74 / 500
      Tasks: 0 / 500
      Window budget: 2955
      Retrieved budget: 1970
      ğŸ“Š Window formatting complete: 10/10 turns included, 0 omitted, 1154/2955 tokens used
   âœ… Prompt built:
      Total tokens: 1297 / 6000
      Window: 1071 tokens
      Retrieved: 130 tokens
      User: 22 tokens
      ğŸ“ Full prompt length: 5140 chars
      ğŸ“‹ Sliding window: 10 turns
   ğŸ“ Debug: Full prompt logged to 04_llm_prompt_20251029_140055_073.txt
   ğŸ¤– Calling LLM with context...
ğŸŒ Sending direct query to external API...
âœ… Chat response received
   ğŸ“Š Phase 4.1: Analyzing context usage...
      Citations found: 0
      Turn IDs used: set()
      Context efficiency: 0.0%

ğŸ’¬ Response: Certainly! Here's an interesting fact about the ocean: The ocean is home to the largest living structure on Earthâ€”the Great Barrier Reef. Stretching over 2,300 kilometers (about 1,430 miles) along the coast of Australia, it's so big that it can be seen from space! The reef is made up of billions of tiny coral polyps and supports an incredible diversity of marine life, including over 1,500 species of fish, 400 kinds of coral, and many other creatures. It's often called the "rainforest of the sea" because of its rich biodiversity. Would you like to hear more ocean facts or learn about a specific ocean-related topic?
   ğŸ“ Debug: LLM response logged to 05_llm_response_20251029_140055_073.txt
   ğŸ“ Extracted 4 keywords from query: ['interesting fact', 'interesting', 'fact', 'ocean']
   ğŸ·ï¸  Using provided topics (4): ['interesting fact', 'interesting', 'fact', 'ocean']
   ğŸ’¾ Logging turn to storage...
   ğŸ’¾ Logged turn t_20251029_140058_31dfba... (seq=0) to day 2025-10-29
      ğŸ”‘ Saved 4 keywords with lineage
   ğŸ“‹ Adding to sliding window...
   ğŸ’¾ Saved sliding window state: 11 turns
   âœ… Turn logged: t_20251029_140058_31dfba
   ğŸ” Generating embeddings from 4 LLM-extracted keywords...
   âš ï¸ Could not generate embeddings: 'EmbeddingManager' object has no attribute 'save_turn_embeddings'
   ğŸ¯ Phase 4.3: Applying adaptive compression...
      ğŸ“Š Sliding window has 11 turns - checking compression...
      Compression decision: no_compression
      Reason: Related topics (distance: 0.000)
      â„¹ï¸  No compression needed
