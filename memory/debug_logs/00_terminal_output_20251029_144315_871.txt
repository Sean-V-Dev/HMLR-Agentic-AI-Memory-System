================================================================================
TERMINAL OUTPUT FOR THIS TURN
================================================================================
Timestamp: 2025-10-29 14:43:16
Turn ID: turn_20251029_144315_871
================================================================================

   ğŸ“ Debug: User query logged to 01_user_query_20251029_144315_871.txt
   ğŸ” Step 1: Quick keyword extraction...
      Quick keywords: ['test query', 'test', 'query']
   ğŸ“š Step 2: Retrieving recent context...
ğŸ” Crawler: Searching with intent:
   Query Type: chat
   Keywords: ['test query', 'test', 'query']
ğŸ“‹ Found 0 active tasks
ğŸ“… Search range: ALL DAYS (unlimited)

ğŸ” VECTOR SEARCH (Primary Method):
   ğŸ” Ranked multi-keyword search: 'test query test query...'
      Query keywords (4): ['test', 'query', 'test', 'query']
      Found 1 turns with keyword matches
   ğŸ¯ Top matches:
      1. score=5.15 | 2 kw matches | avg_sim=0.498 | memory-retrieval tes, memory-retrieval tes...
   âœ… Returning 1 ranked results
   ğŸ”‘ Search query (keywords): 'test query test query'
   âœ… Vector search successful, skipping keyword search

ğŸ“Š SEARCH RESULTS SUMMARY:
   Vector results: 1
   Keyword results: 0
   Total candidates: 1
   âœ… Window tracking: 13 turns in window, 0 recently seen
âœ… Retrieved context: 1 snippets, 1 sources
      Retrieved 1 recent contexts
   ğŸ§  Step 3: Analyzing intent WITH context...
   ğŸ“… Phase 6.2: Analyzing with plan context (4 active plans)
      Type: memory_query
      Keywords: ['test', 'query', 'context', 'metadata', 'intent']
      Topics: ['progressive', 'warm', 'stroll']
   ğŸ“ Debug: User query logged to 01_user_query_20251029_144315_871.txt
   ğŸ·ï¸  Phase 4.1: Using GPT-4o-nano topics...
      Topics: []
   ğŸ” Step 4: Full context retrieval with refined intent...
      Using plan-boosted retrieval (4 active plans)
ğŸ” Crawler: Searching with intent:
   Query Type: memory_query
   Keywords: ['test', 'query', 'context', 'metadata', 'intent', 'understanding', 'previously', 'discussed', 'topics', 'interesting']
   Primary Topics: ['progressive', 'warm', 'stroll']
ğŸ“‹ Found 0 active tasks
ğŸ“… Search range: ALL DAYS (unlimited)

ğŸ” VECTOR SEARCH (Primary Method):
   ğŸ” Ranked multi-keyword search: 'test query context metadata intent understanding previously ...'
      Query keywords (13): ['test', 'query', 'context', 'metadata', 'intent', 'understanding', 'previously', 'discussed', 'topics', 'interesting', 'progressive', 'warm', 'stroll']
      Found 9 turns with keyword matches
   ğŸ¯ Top matches:
      1. score=13.79 | 6 kw matches | avg_sim=0.526 | Conversation, Metadata...
      2. score=7.20 | 3 kw matches | avg_sim=0.535 | memory-retrieval tes, random topic overvie...
      3. score=5.33 | 2 kw matches | avg_sim=0.419 | History, History...
   âœ… Returning 9 ranked results
   ğŸ”‘ Search query (keywords): 'test query context metadata intent understanding previously discussed topics interesting progressive warm stroll'
   âœ… Vector search successful, skipping keyword search

ğŸ“Š SEARCH RESULTS SUMMARY:
   Vector results: 9
   Keyword results: 0
   Total candidates: 9
   ğŸ”„ Deduplicated turns: 9 â†’ 8 (1 skipped)
   âœ… Window tracking: 18 turns in window, 0 recently seen
âœ… Retrieved context: 5 snippets, 3 sources
      Retrieved: 5 contexts (before topic filtering)
      Final context count: 5
   ğŸ“ Debug: Retrieved context logged to 02_retrieved_context_20251029_144315_871.txt
   ğŸ“ Debug: Sliding window logged to 03_sliding_window_20251029_144315_871.txt
   ğŸ’§ Building contextualized prompt...

ğŸ’§ Building prompt...
   ğŸ“Š Token allocation:
      System: 74 / 500
      Tasks: 0 / 500
      Window budget: 2955
      Retrieved budget: 1970
      ğŸ“Š Window formatting complete: 12/12 turns included, 0 omitted, 1187/2955 tokens used
   âœ… Prompt built:
      Total tokens: 1570 / 6000
      Window: 1086 tokens
      Retrieved: 398 tokens
      User: 12 tokens
      ğŸ“ Full prompt length: 6233 chars
      ğŸ“‹ Sliding window: 12 turns
   ğŸ“ Debug: Full prompt logged to 04_llm_prompt_20251029_144315_871.txt
   ğŸ¤– Calling LLM with context...
ğŸŒ Sending direct query to external API (model: gpt-4.1-mini)...
âœ… Chat response received
   ğŸ“Š Phase 4.1: Analyzing context usage...
      Citations found: 0
      Turn IDs used: set()
      Context efficiency: 0.0%

ğŸ’¬ Response: Test query received. How can I assist you further?
   ğŸ“ Debug: LLM response logged to 05_llm_response_20251029_144315_871.txt
   ğŸ“ Using GPT-4o-nano keywords (1): ['test']
   ğŸ·ï¸  Using GPT-4o-nano topics (0): []
   ğŸ˜Š Detected affect: neutral
   ğŸ’¾ Logging turn to storage...
   ğŸ’¾ Logged turn t_20251029_144316_40c616... (seq=0) to day 2025-10-29
      ğŸ”‘ Saved 1 keywords with lineage
      ğŸ˜Š Saved affect with lineage
   ğŸ“‹ Adding to sliding window...
   ğŸ’¾ Saved sliding window state: 13 turns
   âœ… Turn logged: t_20251029_144316_40c616
   ğŸ” Generating embeddings from 1 LLM-extracted keywords...
   ğŸ” Generated 1 keyword embedding(s)
   ğŸ¯ Phase 4.3: Applying adaptive compression...
      ğŸ“Š Sliding window has 13 turns - checking compression...
      Compression decision: no_compression
      Reason: Somewhat different but recent and close topics (dist: 0.634, gap: 0.6h)
      â„¹ï¸  No compression needed
